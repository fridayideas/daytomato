version: 1.0.{build}
configuration: Release
platform: Any CPU

environment:
  ANDROID_HOME: C:\android-sdk
  AndroidSdkDirectory: C:\android-sdk

xamarin:
  email: fridayideasgroup@gmail.com
  password:
    secure: 8G7oASWzzzsic0ngACjkHmj9FCR1cpQ+ahZVHH00npg=
  android: true
  ios: true

before_build:
 - cmd: mklink /j %ANDROID_HOME% "C:\Program Files (x86)\Android\android-sdk"
 - cmd: echo y | "%ANDROID_HOME%\tools\android.bat" update sdk --no-ui --all --filter platform-tools,tools,android-23,android-19

build:
  publish_nuget: true
  publish_nuget_symbols: true
  include_nuget_references: true
  verbosity: minimal
 
branches:
  # whitelist
  only:
    - master

artifacts:
- path: DayTomato\DayTomato.Droid\bin\Release\com.fridayideas.daytomato.apk
  name: project

after_build:
- dir DayTomato\DayTomato.Droid

deploy:
  release: daytomato$(appveyor_build_version)
  description: 'Release description'
  provider: GitHub
  auth_token: $env:GITHUB_TOKEN    # your encrypted token from GitHub
  artifact: project           # upload all NuGet packages to release assets
  draft: false
  prerelease: false
  force_update: true
  on:
    appveyor_repo_tag: true
    branch: master 
  
